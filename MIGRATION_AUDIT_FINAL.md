# üîç –§–ò–ù–ê–õ–¨–ù–´–ô –ê–£–î–ò–¢ –ú–ò–ì–†–ê–¶–ò–ò –ù–ê MANAGED POSTGRESQL

**–î–∞—Ç–∞:** 25 –¥–µ–∫–∞–±—Ä—è 2025  
**–¶–µ–ª—å:** –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

---

## ‚úÖ –ß–¢–û –°–î–ï–õ–ê–ù–û

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **Managed PostgreSQL** –Ω–∞ Yandex.Cloud –ø–æ–¥–∫–ª—é—á–µ–Ω
- ‚úÖ **32 —Ç–∞–±–ª–∏—Ü—ã** —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ **43 –ø—Ä–æ—Ñ–∏–ª—è** –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ **20 –æ—Ç–∑—ã–≤–æ–≤** –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ **12 –ª–æ–∫–∞—Ü–∏–π** –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ **7 –∫–∞—Ç–µ–≥–æ—Ä–∏–π** —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
- ‚úÖ **1 –æ–±—ä—è–≤–ª–µ–Ω–∏–µ** + **1 –∫–∞–º–ø–∞–Ω–∏—è** —Ä–∞–±–æ—Ç–∞—é—Ç

### 2. Prisma
- ‚úÖ Schema —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏–∑ –ë–î
- ‚úÖ Prisma Client —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω
- ‚úÖ –ú–æ–¥–µ–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç–∞–±–ª–∏—Ü–∞–º

### 3. –ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ API (–Ω–∞ Prisma)
- ‚úÖ `/api/profiles/public` - —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ñ–∏–ª–µ–π
- ‚úÖ `/api/profiles/by-slug/[slug]` - –ø—Ä–æ—Ñ–∏–ª—å –ø–æ slug
- ‚úÖ `/api/category-images` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- ‚úÖ `/api/advertising/active-banners` - –∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- ‚úÖ `/api/advertising/track` - tracking impressions/clicks
- ‚úÖ `/api/auth/yandex/callback` - Yandex OAuth (JWT)

### 4. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ —Å Supabase Auth –Ω–∞ JWT
- ‚úÖ Yandex OAuth —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Middleware –∏—Å–ø–æ–ª—å–∑—É–µ—Ç JWT

---

## ‚ùå –ß–¢–û –ù–ï –°–î–ï–õ–ê–ù–û / –¢–†–ï–ë–£–ï–¢ –ü–†–û–í–ï–†–ö–ò

### 1. UNMIGRATED API (–µ—â—ë –∏—Å–ø–æ–ª—å–∑—É—é—Ç Supabase client)

**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:** ~167 API routes  
**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É—é—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ Prisma

#### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ API (–Ω—É–∂–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–∞–π—Ç–∞):
- ‚ùì `/api/reviews` - –æ—Ç–∑—ã–≤—ã (–ß–ê–°–¢–ò–ß–ù–û –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω GET, –Ω—É–∂–µ–Ω POST/PATCH/DELETE)
- ‚ùì `/api/services` - —É—Å–ª—É–≥–∏ (–ß–ê–°–¢–ò–ß–ù–û –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω GET)
- ‚ùì `/api/master-class-programs` - –ø—Ä–æ–≥—Ä–∞–º–º—ã –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å–æ–≤ (GET/POST –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã)
- ‚ùì `/api/agency-partners` - –ø–∞—Ä—Ç–Ω—ë—Ä—ã –∞–≥–µ–Ω—Ç—Å—Ç–≤ (GET –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω)
- ‚ùì `/api/profiles/[id]` - CRUD –ø—Ä–æ—Ñ–∏–ª–µ–π
- ‚ùì `/api/requests` - –∑–∞—è–≤–∫–∏ –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤
- ‚ùì `/api/upload` - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- ‚ùì `/api/analytics/track` - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- ‚ùì `/api/notifications` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚ùì `/api/conversations` - —á–∞—Ç—ã

#### –ù–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ API (–∞–¥–º–∏–Ω–∫–∞, –¥–æ–ø. —Ñ—É–Ω–∫—Ü–∏–∏):
- ‚ùì `/api/admin/*` - –∞–¥–º–∏–Ω–∫–∞
- ‚ùì `/api/ai/*` - AI —Ñ—É–Ω–∫—Ü–∏–∏
- ‚ùì `/api/payments/*` - –ø–ª–∞—Ç–µ–∂–∏
- ‚ùì `/api/telegram/*` - Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚ùì `/api/vk-*` - VK –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚ùì `/api/2gis-reviews/*` - –ø–∞—Ä—Å–∏–Ω–≥ –æ—Ç–∑—ã–≤–æ–≤

### 2. –ü–£–°–¢–´–ï –¢–ê–ë–õ–ò–¶–´ (–¥–∞–Ω–Ω—ã–µ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã)
- ‚ùå `agency_cases` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `agency_partners` - 0 –∑–∞–ø–∏—Å–µ–π (—Ö–æ—Ç—è GET API –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω!)
- ‚ùå `animator_characters` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `show_programs` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `quest_programs` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `ad_bookings` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `order_requests` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `user_activity` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `profile_activities` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `services` - 0 –∑–∞–ø–∏—Å–µ–π

### 3. FOREIGN KEY ISSUES
- ‚ö†Ô∏è `advertisements.profile_id` –Ω–µ —Å–≤—è–∑–∞–Ω —Å `ad_campaigns` (—Ç–æ–ª—å–∫–æ 1 –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Å –∫–∞–º–ø–∞–Ω–∏–µ–π)
- ‚ö†Ô∏è –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –º–æ–≥—É—Ç –Ω–µ –∏–º–µ—Ç—å –∫–∞–º–ø–∞–Ω–∏–π

### 4. STORAGE (—Ñ–∞–π–ª—ã)
- ‚ùì –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ñ–∞–π–ª—ã —Å–µ–π—á–∞—Å?
- ‚ùì Supabase Storage –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ?
- ‚ùì `/api/upload` –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω?

### 5. ENVIRONMENT VARIABLES
- ‚ö†Ô∏è `NEXT_PUBLIC_SUPABASE_URL` = dummy (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
- ‚ö†Ô∏è `NEXT_PUBLIC_SUPABASE_ANON_KEY` = dummy (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
- ‚ö†Ô∏è `SUPABASE_SERVICE_ROLE_KEY` = dummy
- ‚ö†Ô∏è –≠—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤—Å—ë –µ—â—ë –Ω—É–∂–Ω—ã –¥–ª—è legacy –∫–æ–¥–∞

---

## üî• –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

1. **~167 API routes –ù–ï –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç Supabase client
2. **9 —Ç–∞–±–ª–∏—Ü –ø—É—Å—Ç—ã–µ** - –¥–∞–Ω–Ω—ã–µ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
3. **–ù–µ—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏** - —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, —á—Ç–æ –Ω–µ—Ç
4. **Storage –Ω–µ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω** - —Ñ–∞–π–ª—ã –≥–¥–µ-—Ç–æ –≤ Supabase?

---

## üìã –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –í–ê–†–ò–ê–ù–¢ A: –î–æ–≤–µ—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏—é –¥–æ –∫–æ–Ω—Ü–∞ (–†–ï–ö–û–ú–ï–ù–î–£–Æ)
1. ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ Supabase
2. ‚úÖ –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –í–°–ï –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ API –Ω–∞ Prisma
3. ‚úÖ –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ Storage –Ω–∞ Yandex Object Storage
4. ‚úÖ –£–¥–∞–ª–∏—Ç—å dummy Supabase –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
5. ‚úÖ –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –í–°–ï–• —Ñ—É–Ω–∫—Ü–∏–π

**–í—Ä–µ–º—è:** 4-6 —á–∞—Å–æ–≤  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–∑–∞–≤–∏—Å–∏–º–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞ Yandex.Cloud

### –í–ê–†–ò–ê–ù–¢ B: –û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å (–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–Æ)
- –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç (–≥–ª–∞–≤–Ω–∞—è, –ø—Ä–æ—Ñ–∏–ª–∏, –æ–±—ä—è–≤–ª–µ–Ω–∏—è)
- 167 API routes –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ Supabase client (–º–æ–≥—É—Ç —Å–ª–æ–º–∞—Ç—å—Å—è)
- –†–∏—Å–∫: –ª—é–±–æ–π unmigrated API –≤—ã–¥–∞—Å—Ç 500 –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏

---

## üéØ –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°

**–†–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–ø—Ä–æ—Ñ–∏–ª–∏, –æ–±—ä—è–≤–ª–µ–Ω–∏—è)
- ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏
- ‚úÖ Yandex –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- ‚úÖ Tracking –æ–±—ä—è–≤–ª–µ–Ω–∏–π

**–ù–ï –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚ùì –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π
- ‚ùì –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤
- ‚ùì –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫
- ‚ùì –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- ‚ùì –ß–∞—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚ùì –ê–¥–º–∏–Ω–∫–∞

---

## üí¨ –í–û–ü–†–û–° –ö –¢–ï–ë–ï

**–ö–∞–∫ –¥–µ–π—Å—Ç–≤—É–µ–º?**

1. **–í–∞—Ä–∏–∞–Ω—Ç A** - –î–æ–≤–æ–∂—É –º–∏–≥—Ä–∞—Ü–∏—é –¥–æ –∫–æ–Ω—Ü–∞ —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–≤—Å–µ API + –≤—Å–µ –¥–∞–Ω–Ω—ã–µ)
2. **–í–∞—Ä–∏–∞–Ω—Ç B** - –û—Å—Ç–∞–≤–ª—è—é –∫–∞–∫ –µ—Å—Ç—å, —Ñ–∏–∫—Å–∏—Ä—É—é —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –±–∞–≥–∏ –ø–æ –º–µ—Ä–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è
3. **–í–∞—Ä–∏–∞–Ω—Ç C** - –î–µ–ª–∞–µ–º checkpoint: —Ä–∞–±–æ—Ç–∞—é—â–µ–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º, unmigrated API –æ—Å—Ç–∞–≤–ª—è–µ–º –Ω–∞ Supabase

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê

- **–í—Å–µ–≥–æ API routes:** 173
- **–ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ Prisma:** ~6 (3%)
- **–û—Å—Ç–∞–ª–æ—Å—å –Ω–∞ Supabase:** ~167 (97%)
- **–¢–∞–±–ª–∏—Ü –≤ –ë–î:** 32
- **–¢–∞–±–ª–∏—Ü —Å –¥–∞–Ω–Ω—ã–º–∏:** 11
- **–ü—É—Å—Ç—ã—Ö —Ç–∞–±–ª–∏—Ü:** 21


**–î–∞—Ç–∞:** 25 –¥–µ–∫–∞–±—Ä—è 2025  
**–¶–µ–ª—å:** –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

---

## ‚úÖ –ß–¢–û –°–î–ï–õ–ê–ù–û

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **Managed PostgreSQL** –Ω–∞ Yandex.Cloud –ø–æ–¥–∫–ª—é—á–µ–Ω
- ‚úÖ **32 —Ç–∞–±–ª–∏—Ü—ã** —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ **43 –ø—Ä–æ—Ñ–∏–ª—è** –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ **20 –æ—Ç–∑—ã–≤–æ–≤** –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ **12 –ª–æ–∫–∞—Ü–∏–π** –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ **7 –∫–∞—Ç–µ–≥–æ—Ä–∏–π** —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
- ‚úÖ **1 –æ–±—ä—è–≤–ª–µ–Ω–∏–µ** + **1 –∫–∞–º–ø–∞–Ω–∏—è** —Ä–∞–±–æ—Ç–∞—é—Ç

### 2. Prisma
- ‚úÖ Schema —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏–∑ –ë–î
- ‚úÖ Prisma Client —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω
- ‚úÖ –ú–æ–¥–µ–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç–∞–±–ª–∏—Ü–∞–º

### 3. –ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ API (–Ω–∞ Prisma)
- ‚úÖ `/api/profiles/public` - —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ñ–∏–ª–µ–π
- ‚úÖ `/api/profiles/by-slug/[slug]` - –ø—Ä–æ—Ñ–∏–ª—å –ø–æ slug
- ‚úÖ `/api/category-images` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- ‚úÖ `/api/advertising/active-banners` - –∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- ‚úÖ `/api/advertising/track` - tracking impressions/clicks
- ‚úÖ `/api/auth/yandex/callback` - Yandex OAuth (JWT)

### 4. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ —Å Supabase Auth –Ω–∞ JWT
- ‚úÖ Yandex OAuth —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Middleware –∏—Å–ø–æ–ª—å–∑—É–µ—Ç JWT

---

## ‚ùå –ß–¢–û –ù–ï –°–î–ï–õ–ê–ù–û / –¢–†–ï–ë–£–ï–¢ –ü–†–û–í–ï–†–ö–ò

### 1. UNMIGRATED API (–µ—â—ë –∏—Å–ø–æ–ª—å–∑—É—é—Ç Supabase client)

**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:** ~167 API routes  
**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É—é—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ Prisma

#### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ API (–Ω—É–∂–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–∞–π—Ç–∞):
- ‚ùì `/api/reviews` - –æ—Ç–∑—ã–≤—ã (–ß–ê–°–¢–ò–ß–ù–û –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω GET, –Ω—É–∂–µ–Ω POST/PATCH/DELETE)
- ‚ùì `/api/services` - —É—Å–ª—É–≥–∏ (–ß–ê–°–¢–ò–ß–ù–û –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω GET)
- ‚ùì `/api/master-class-programs` - –ø—Ä–æ–≥—Ä–∞–º–º—ã –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å–æ–≤ (GET/POST –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã)
- ‚ùì `/api/agency-partners` - –ø–∞—Ä—Ç–Ω—ë—Ä—ã –∞–≥–µ–Ω—Ç—Å—Ç–≤ (GET –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω)
- ‚ùì `/api/profiles/[id]` - CRUD –ø—Ä–æ—Ñ–∏–ª–µ–π
- ‚ùì `/api/requests` - –∑–∞—è–≤–∫–∏ –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤
- ‚ùì `/api/upload` - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- ‚ùì `/api/analytics/track` - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- ‚ùì `/api/notifications` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚ùì `/api/conversations` - —á–∞—Ç—ã

#### –ù–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ API (–∞–¥–º–∏–Ω–∫–∞, –¥–æ–ø. —Ñ—É–Ω–∫—Ü–∏–∏):
- ‚ùì `/api/admin/*` - –∞–¥–º–∏–Ω–∫–∞
- ‚ùì `/api/ai/*` - AI —Ñ—É–Ω–∫—Ü–∏–∏
- ‚ùì `/api/payments/*` - –ø–ª–∞—Ç–µ–∂–∏
- ‚ùì `/api/telegram/*` - Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚ùì `/api/vk-*` - VK –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚ùì `/api/2gis-reviews/*` - –ø–∞—Ä—Å–∏–Ω–≥ –æ—Ç–∑—ã–≤–æ–≤

### 2. –ü–£–°–¢–´–ï –¢–ê–ë–õ–ò–¶–´ (–¥–∞–Ω–Ω—ã–µ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã)
- ‚ùå `agency_cases` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `agency_partners` - 0 –∑–∞–ø–∏—Å–µ–π (—Ö–æ—Ç—è GET API –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω!)
- ‚ùå `animator_characters` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `show_programs` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `quest_programs` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `ad_bookings` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `order_requests` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `user_activity` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `profile_activities` - 0 –∑–∞–ø–∏—Å–µ–π
- ‚ùå `services` - 0 –∑–∞–ø–∏—Å–µ–π

### 3. FOREIGN KEY ISSUES
- ‚ö†Ô∏è `advertisements.profile_id` –Ω–µ —Å–≤—è–∑–∞–Ω —Å `ad_campaigns` (—Ç–æ–ª—å–∫–æ 1 –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Å –∫–∞–º–ø–∞–Ω–∏–µ–π)
- ‚ö†Ô∏è –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –º–æ–≥—É—Ç –Ω–µ –∏–º–µ—Ç—å –∫–∞–º–ø–∞–Ω–∏–π

### 4. STORAGE (—Ñ–∞–π–ª—ã)
- ‚ùì –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ñ–∞–π–ª—ã —Å–µ–π—á–∞—Å?
- ‚ùì Supabase Storage –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ?
- ‚ùì `/api/upload` –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω?

### 5. ENVIRONMENT VARIABLES
- ‚ö†Ô∏è `NEXT_PUBLIC_SUPABASE_URL` = dummy (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
- ‚ö†Ô∏è `NEXT_PUBLIC_SUPABASE_ANON_KEY` = dummy (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
- ‚ö†Ô∏è `SUPABASE_SERVICE_ROLE_KEY` = dummy
- ‚ö†Ô∏è –≠—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤—Å—ë –µ—â—ë –Ω—É–∂–Ω—ã –¥–ª—è legacy –∫–æ–¥–∞

---

## üî• –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

1. **~167 API routes –ù–ï –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç Supabase client
2. **9 —Ç–∞–±–ª–∏—Ü –ø—É—Å—Ç—ã–µ** - –¥–∞–Ω–Ω—ã–µ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
3. **–ù–µ—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏** - —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, —á—Ç–æ –Ω–µ—Ç
4. **Storage –Ω–µ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω** - —Ñ–∞–π–ª—ã –≥–¥–µ-—Ç–æ –≤ Supabase?

---

## üìã –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –í–ê–†–ò–ê–ù–¢ A: –î–æ–≤–µ—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏—é –¥–æ –∫–æ–Ω—Ü–∞ (–†–ï–ö–û–ú–ï–ù–î–£–Æ)
1. ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ Supabase
2. ‚úÖ –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –í–°–ï –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ API –Ω–∞ Prisma
3. ‚úÖ –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ Storage –Ω–∞ Yandex Object Storage
4. ‚úÖ –£–¥–∞–ª–∏—Ç—å dummy Supabase –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
5. ‚úÖ –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –í–°–ï–• —Ñ—É–Ω–∫—Ü–∏–π

**–í—Ä–µ–º—è:** 4-6 —á–∞—Å–æ–≤  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–∑–∞–≤–∏—Å–∏–º–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞ Yandex.Cloud

### –í–ê–†–ò–ê–ù–¢ B: –û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å (–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–Æ)
- –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç (–≥–ª–∞–≤–Ω–∞—è, –ø—Ä–æ—Ñ–∏–ª–∏, –æ–±—ä—è–≤–ª–µ–Ω–∏—è)
- 167 API routes –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ Supabase client (–º–æ–≥—É—Ç —Å–ª–æ–º–∞—Ç—å—Å—è)
- –†–∏—Å–∫: –ª—é–±–æ–π unmigrated API –≤—ã–¥–∞—Å—Ç 500 –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏

---

## üéØ –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°

**–†–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–ø—Ä–æ—Ñ–∏–ª–∏, –æ–±—ä—è–≤–ª–µ–Ω–∏—è)
- ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏
- ‚úÖ Yandex –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- ‚úÖ Tracking –æ–±—ä—è–≤–ª–µ–Ω–∏–π

**–ù–ï –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚ùì –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π
- ‚ùì –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤
- ‚ùì –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫
- ‚ùì –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- ‚ùì –ß–∞—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚ùì –ê–¥–º–∏–Ω–∫–∞

---

## üí¨ –í–û–ü–†–û–° –ö –¢–ï–ë–ï

**–ö–∞–∫ –¥–µ–π—Å—Ç–≤—É–µ–º?**

1. **–í–∞—Ä–∏–∞–Ω—Ç A** - –î–æ–≤–æ–∂—É –º–∏–≥—Ä–∞—Ü–∏—é –¥–æ –∫–æ–Ω—Ü–∞ —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–≤—Å–µ API + –≤—Å–µ –¥–∞–Ω–Ω—ã–µ)
2. **–í–∞—Ä–∏–∞–Ω—Ç B** - –û—Å—Ç–∞–≤–ª—è—é –∫–∞–∫ –µ—Å—Ç—å, —Ñ–∏–∫—Å–∏—Ä—É—é —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –±–∞–≥–∏ –ø–æ –º–µ—Ä–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è
3. **–í–∞—Ä–∏–∞–Ω—Ç C** - –î–µ–ª–∞–µ–º checkpoint: —Ä–∞–±–æ—Ç–∞—é—â–µ–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º, unmigrated API –æ—Å—Ç–∞–≤–ª—è–µ–º –Ω–∞ Supabase

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê

- **–í—Å–µ–≥–æ API routes:** 173
- **–ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ Prisma:** ~6 (3%)
- **–û—Å—Ç–∞–ª–æ—Å—å –Ω–∞ Supabase:** ~167 (97%)
- **–¢–∞–±–ª–∏—Ü –≤ –ë–î:** 32
- **–¢–∞–±–ª–∏—Ü —Å –¥–∞–Ω–Ω—ã–º–∏:** 11
- **–ü—É—Å—Ç—ã—Ö —Ç–∞–±–ª–∏—Ü:** 21




