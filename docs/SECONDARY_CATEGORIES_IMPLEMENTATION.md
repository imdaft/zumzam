# โ ะะตะฐะปะธะทะพะฒะฐะฝะฐ ะฟะพะดะดะตัะถะบะฐ ะผะฝะพะถะตััะฒะตะฝะฝัั ะบะฐัะตะณะพัะธะน ะฟัะพัะธะปั

**ะะฐัะฐ:** 8 ะดะตะบะฐะฑัั 2024  
**ะัะพะฑะปะตะผะฐ:** ะะธะฑัะธะดะฝัะต ะฑะธะทะฝะตัั (Kids Point, ะธ ะดั.) ะฝะต ะฒะปะตะทะฐัั ะฒ ะพะดะฝั ะบะฐัะตะณะพัะธั

## ๐ฏ ะะตัะตะฝะธะต:

ะัะพัะธะปั ัะตะฟะตัั ะผะพะถะตั ะฑััั **ะฒ ะฝะตัะบะพะปัะบะธั ะบะฐัะตะณะพัะธัั ะพะดะฝะพะฒัะตะผะตะฝะฝะพ**:
- 1 ะพัะฝะพะฒะฝะฐั ะบะฐัะตะณะพัะธั (ะพะฑัะทะฐัะตะปัะฝะพ)
- 0-3 ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ะบะฐัะตะณะพัะธะธ (ะพะฟัะธะพะฝะฐะปัะฝะพ)

---

## ๐ ะัะธะผะตั: Kids Point

```json
{
  "display_name": "Kids Point",
  "category": "venue",  // ะัะฝะพะฒะฝะฐั
  "secondary_categories": ["master_class"],  // ะะพะฟะพะปะฝะธัะตะปัะฝัะต
  "details": {
    "venue_type": "entertainment_center"
  }
}
```

**ะะฐัะพะดะธััั ะฒ ะฟะพะธัะบะต ะฟะพ ะทะฐะฟัะพัะฐะผ:**
- "ะะปะพัะฐะดะบะฐ ะดะปั ะฟัะฐะทะดะฝะธะบะฐ" โ
- "ะะฐััะตั-ะบะปะฐัั" โ
- "ะะตััะบะธะน ัะตะฝัั" โ

---

## ๐๏ธ ะงัะพ ัะตะฐะปะธะทะพะฒะฐะฝะพ:

### 1. **UI ะบะพะผะฟะพะฝะตะฝั** (`SecondaryCategoriesSelector`)

```tsx
<SecondaryCategoriesSelector
  primaryCategory="venue"
  selected={['master_class']}
  onChange={(categories) => { ... }}
/>
```

**ะัะพะฑะตะฝะฝะพััะธ:**
- ะัะฐัะธะฒัะต ะบะฐััะพัะบะธ ั ะธะบะพะฝะบะฐะผะธ
- Checkbox ะดะปั ะผะฝะพะถะตััะฒะตะฝะฝะพะณะพ ะฒัะฑะพัะฐ
- ะะฟะธัะฐะฝะธั ะดะปั ะบะฐะถะดะพะน ะบะฐัะตะณะพัะธะธ
- ะะดะฐะฟัะธะฒะฝัะน ะดะธะทะฐะนะฝ

**ะะพะณะธะบะฐ ะฒัะฑะพัะฐ:**
```typescript
// ะะฐะบะธะต ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ะบะฐัะตะณะพัะธะธ ะดะพัััะฟะฝั
venue โ ['master_class', 'show', 'photographer']
animator โ ['show']
show โ ['photographer']
master_class โ ['show', 'photographer']
photographer โ []
agency โ []
quest โ []
```

---

### 2. **ะะฝัะตะณัะฐัะธั ะฒ ัะพัะผั ัะพะทะดะฐะฝะธั**

```
ะจะฐะณ 1: ะะฐัะตะณะพัะธั
  โโโ ะัะฑะพั ะพัะฝะพะฒะฝะพะน ะบะฐัะตะณะพัะธะธ (ะพะฑัะทะฐัะตะปัะฝะพ)

ะจะฐะณ 1.5: ะะพะฟะพะปะฝะธัะตะปัะฝัะต ััะปัะณะธ (ะะะะะ!)
  โโโ ะัะฑะพั ะดะพะฟะพะปะฝะธัะตะปัะฝัั ะบะฐัะตะณะพัะธะน (ะพะฟัะธะพะฝะฐะปัะฝะพ)

ะจะฐะณ 2: ะขะธะฟ ะฟะปะพัะฐะดะบะธ (ะตัะปะธ venue)
  โโโ ะัะฑะพั ัะธะฟะฐ

ะจะฐะณ 3: ะฅะฐัะฐะบัะตัะธััะธะบะธ
  โโโ ะกะฟะตัะธัะธัะฝัะต ะฟะพะปั
```

---

### 3. **ะะฐะทะฐ ะดะฐะฝะฝัั** (SQL ะผะธะณัะฐัะธั)

```sql
-- ะะพะฒะฐั ะบะพะปะพะฝะบะฐ
ALTER TABLE profiles 
ADD COLUMN secondary_categories TEXT[] DEFAULT '{}';

-- ะะฝะดะตะบัั ะดะปั ะฟะพะธัะบะฐ
CREATE INDEX idx_profiles_secondary_categories 
ON profiles USING GIN(secondary_categories);

-- ะคัะฝะบัะธั ะดะปั ะฟัะพะฒะตัะบะธ
CREATE FUNCTION profile_has_category(...) ...

-- Constraint
ALTER TABLE profiles 
ADD CONSTRAINT check_secondary_categories_valid 
CHECK (
  secondary_categories <@ ARRAY[
    'venue', 'animator', 'show', 'agency', 
    'quest', 'master_class', 'photographer', 'catering'
  ]::text[]
);
```

---

### 4. **API** (`app/api/profiles/route.ts`)

```typescript
// POST /api/profiles
const {
  category,
  secondary_categories,  // โ ะะะะะ
  ...
} = body

const profileData = {
  category: category || 'venue',
  secondary_categories: secondary_categories || [],  // โ ะะะะะ
  ...
}
```

---

### 5. **ะะฐะปะธะดะฐัะธั** (`lib/validations/profile.ts`)

```typescript
export const profileSchema = z.object({
  category: z.enum([...]),
  
  secondary_categories: z  // โ ะะะะะ
    .array(
      z.enum([...])
    )
    .optional()
    .default([]),
  
  ...
})
```

---

## ๐ ะะพะธัะบ ะฟัะพัะธะปะตะน:

### SQL ะทะฐะฟัะพั:

```sql
-- ะะฐะนัะธ ะฒัะต ะฟัะพัะธะปะธ ะบะฐัะตะณะพัะธะธ 'master_class'
SELECT * FROM profiles 
WHERE profile_has_category(
  category, 
  secondary_categories, 
  'master_class'
);

-- ะะปะธ ัะตัะตะท GIN ะธะฝะดะตะบั
SELECT * FROM profiles 
WHERE 'master_class' = ANY(
  ARRAY[category::text] || 
  COALESCE(secondary_categories, '{}'::text[])
);
```

### TypeScript (Supabase):

```typescript
// ะะฐะนัะธ ะฟัะพัะธะปะธ ั master_class (ะพัะฝะพะฒะฝะฐั ะะะ ะดะพะฟะพะปะฝะธัะตะปัะฝะฐั)
const { data } = await supabase
  .from('profiles')
  .select('*')
  .or(`category.eq.master_class,secondary_categories.cs.{master_class}`)
```

---

## ๐ฑ ะัะพะฑัะฐะถะตะฝะธะต ะฒ ะบะฐััะพัะบะต:

```tsx
<div className="flex gap-2">
  {/* ะัะฝะพะฒะฝะฐั */}
  <Badge variant="primary">
    ๐ข ะะปะพัะฐะดะบะฐ
  </Badge>
  
  {/* ะะพะฟะพะปะฝะธัะตะปัะฝัะต */}
  {profile.secondary_categories?.map(cat => (
    <Badge key={cat} variant="secondary">
      ๐จ ะะฐััะตั-ะบะปะฐััั
    </Badge>
  ))}
</div>
```

---

## ๐ ะััะธัะตะบัััะฐ:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะัะพัะธะปั (Kids Point)               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ category: "venue"                  โ
โ secondary_categories: [            โ
โ   "master_class"                   โ
โ ]                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
         โ
         โโโโบ ะะพะธัะบ "ะะปะพัะฐะดะบะฐ" โ
         โโโโบ ะะพะธัะบ "ะะฐััะตั-ะบะปะฐัั" โ
         โโโโบ ะะพะธัะบ "ะะตััะบะธะน ัะตะฝัั" โ
```

---

## โ ะงะตะบะปะธัั:

- [x] ะกะพะทะดะฐะฝ UI ะบะพะผะฟะพะฝะตะฝั `SecondaryCategoriesSelector`
- [x] ะะฝัะตะณัะธัะพะฒะฐะฝ ะฒ ัะพัะผั ัะพะทะดะฐะฝะธั ะฟัะพัะธะปั
- [x] SQL ะผะธะณัะฐัะธั ะฟัะธะผะตะฝะตะฝะฐ
- [x] API ะพะฑะฝะพะฒะปะตะฝะพ (POST /api/profiles)
- [x] ะะฐะปะธะดะฐัะธั ะพะฑะฝะพะฒะปะตะฝะฐ (Zod ััะตะผะฐ)
- [x] ะะฝะดะตะบัั ะดะปั ะฑััััะพะณะพ ะฟะพะธัะบะฐ
- [x] ะคัะฝะบัะธั `profile_has_category()`
- [x] Constraint ะดะปั ะฒะฐะปะธะดะฝัั ะทะฝะฐัะตะฝะธะน
- [x] ะะธะฝัะตั ัะธัั
- [x] TypeScript ัะธะฟั ะพะฑะฝะพะฒะปะตะฝั

---

## ๐ฏ ะะตะทัะปััะฐั:

โ **Kids Point** ัะตะฟะตัั ะฝะฐัะพะดะธััั ะธ ะบะฐะบ "ะะปะพัะฐะดะบะฐ", ะธ ะบะฐะบ "ะะฐััะตั-ะบะปะฐัั"  
โ **ะะธะฑัะธะดะฝัะต ะฑะธะทะฝะตัั** ะบะพััะตะบัะฝะพ ะฟัะตะดััะฐะฒะปะตะฝั  
โ **ะะพะธัะบ** ัะฐะฑะพัะฐะตั ะฟะพ ะฒัะตะผ ะบะฐัะตะณะพัะธัะผ  
โ **UI** ะฟะพะฝััะตะฝ ะธ ะบัะฐัะธะฒ  
โ **ะะฐะทะฐ ะดะฐะฝะฝัั** ะพะฟัะธะผะธะทะธัะพะฒะฐะฝะฐ  

**ะกัะฐััั:** โ ะะพัะพะฒะพ ะบ ะฟัะพะดะฐะบัะตะฝั! ๐















