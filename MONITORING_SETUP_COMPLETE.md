# ‚úÖ –°–ò–°–¢–ï–ú–ê –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê –£–°–¢–ê–ù–û–í–õ–ï–ù–ê

**–î–∞—Ç–∞:** 26 –¥–µ–∫–∞–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

## üéØ –ß–¢–û –£–°–¢–ê–ù–û–í–õ–ï–ù–û

### 1. Prisma Monitoring (–ë–î)

**–§–∞–π–ª:** `lib/monitoring/prisma-monitor.ts`

‚úÖ Middleware –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (>1000ms)  
‚úÖ –°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –º–æ–¥–µ–ª—è–º –∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º  
‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –ë–î  

**–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤:** `lib/prisma.ts`

### 2. API Monitoring

**–§–∞–π–ª:** `lib/monitoring/api-monitor.ts`

‚úÖ –û–±—ë—Ä—Ç–∫–∞ `withApiMonitoring()` –¥–ª—è API routes  
‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ API  
‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (>2000ms)  
‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ endpoints –∏ —Å—Ç–∞—Ç—É—Å –∫–æ–¥–∞–º  

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```typescript
import { withApiMonitoring } from '@/lib/monitoring/api-monitor'

export const GET = withApiMonitoring(async (request) => {
  // –≤–∞—à –∫–æ–¥
}, '/api/endpoint')
```

### 3. Error Tracking

**–§–∞–π–ª:** `lib/monitoring/error-tracker.ts`

‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ—à–∏–±–æ–∫  
‚úÖ –ü–µ—Ä–µ—Ö–≤–∞—Ç unhandled promise rejections  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—à–∏–±–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä  
‚úÖ –ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 50 –æ—à–∏–±–æ–∫  

**–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤:** `app/layout.tsx` —á–µ—Ä–µ–∑ `MonitoringProvider`

### 4. Diagnostics System

**–§–∞–π–ª:** `lib/monitoring/diagnostics.ts`

‚úÖ –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã  
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î  
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö  
‚úÖ –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏  
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤  

### 5. API Endpoints

#### Health Check
- **URL:** `GET /api/health`
- **–î–æ—Å—Ç—É–ø:** –ü—É–±–ª–∏—á–Ω—ã–π
- **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã, –≤–µ—Ä—Å–∏—é, –ø–∞–º—è—Ç—å

#### Monitoring Stats
- **URL:** `GET /api/monitoring/stats?type=all|prisma|api`
- **–î–æ—Å—Ç—É–ø:** –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã
- **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤

#### Diagnostics
- **URL:** `GET /api/monitoring/diagnostics?type=quick|full`
- **–î–æ—Å—Ç—É–ø:** –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã
- **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### 6. Web Dashboard

**URL:** `/monitoring` (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)

‚úÖ –í–∏–∑—É–∞–ª—å–Ω—ã–π dashboard —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏  
‚úÖ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥  
‚úÖ –ì—Ä–∞—Ñ–∏–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞  
‚úÖ –°–ø–∏—Å–æ–∫ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤  
‚úÖ –ò—Å—Ç–æ—Ä–∏—è –æ—à–∏–±–æ–∫  

### 7. CLI Tools

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã
```bash
npm run check-system
# –∏–ª–∏
node scripts/check-system.mjs
```

‚úÖ –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤  
‚úÖ –¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ —Å –∏–∫–æ–Ω–∫–∞–º–∏  
‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö  

---

## üìä –ß–¢–û –û–¢–°–õ–ï–ñ–ò–í–ê–ï–¢–°–Ø

### Prisma (–ë–î)
- ‚è±Ô∏è –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
- üêå –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (>1000ms)
- ‚ùå –û—à–∏–±–∫–∏ –ë–î —Å –ø–æ–ª–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–æ–¥–µ–ª—è–º (profiles, users, services –∏ —Ç.–¥.)
- üìà –°—á–µ—Ç—á–∏–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–π (findMany, create, update, delete)

### API
- ‚è±Ô∏è –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –∫–∞–∂–¥–æ–≥–æ endpoint
- üêå –ú–µ–¥–ª–µ–Ω–Ω—ã–µ API –∑–∞–ø—Ä–æ—Å—ã (>2000ms)
- üî¢ HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã (200, 404, 500 –∏ —Ç.–¥.)
- üìä –ß–∞—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è endpoints
- ‚ùå –û—à–∏–±–∫–∏ 4xx –∏ 5xx

### Errors
- üí• –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ JavaScript –æ—à–∏–±–∫–∏
- üî¥ Promise rejections
- üêõ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏
- üìç URL –∏ user agent –ø—Ä–∏ –æ—à–∏–±–∫–µ
- üìö Stack traces

### System
- üíæ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ (heap, RSS)
- üîå –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- üì¶ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö
- üîó –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö (orphaned records)
- ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–∏–ø–∏—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

## üöÄ –ö–ê–ö –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨

### –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

1. **–£—Ç—Ä–æ–º:**
   ```bash
   npm run check-system
   ```
   –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—Å–µ –∑–µ–ª—ë–Ω—ã–µ –≥–∞–ª–æ—á–∫–∏ ‚úÖ

2. **–í —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ `/monitoring` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
   - –°–ª–µ–¥–∏—Ç–µ –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—à–∏–±–æ–∫
   - –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

3. **–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ `/monitoring`
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ "–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—à–∏–±–∫–∏"
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–ª–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É:
     ```bash
     curl http://localhost:3000/api/monitoring/diagnostics?type=full
     ```

### –ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã
npm run check-system

# 2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –Ω–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
# 3. –û—á–∏—Å—Ç–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è —á–∏—Å—Ç–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞
curl -X DELETE http://localhost:3000/api/monitoring/stats?type=all
```

### –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health
curl https://your-domain.com/api/health

# 2. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º 5-10 –º–∏–Ω—É—Ç
# –û—Ç–∫—Ä–æ–π—Ç–µ: https://your-domain.com/monitoring

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
curl https://your-domain.com/api/monitoring/diagnostics?type=full
```

---

## üìù –õ–û–ì–ò

–í—Å–µ –ª–æ–≥–∏ –∏–¥—É—Ç —á–µ—Ä–µ–∑ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ª–æ–≥–≥–µ—Ä:

```typescript
import { logger } from '@/lib/logger'

logger.debug('[Component] Debug info')  // —Ç–æ–ª—å–∫–æ –≤ dev
logger.info('[API] Request received')   // –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
logger.warn('[Auth] Token expiring')    // –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
logger.error('[DB] Query failed', err)  // –æ—à–∏–±–∫–∏
```

**–§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤:**

```
[10:23:45] ‚ÑπÔ∏è [API] GET /api/profiles ‚Üí 200 (45ms)
[10:23:46] ‚ö†Ô∏è [Prisma] üêå –ú–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å: services.findMany (1247ms)
[10:23:47] ‚ùå [Prisma] –û—à–∏–±–∫–∞ –≤ users.update
```

---

## üîß –ù–ê–°–¢–†–û–ô–ö–ò

### –ü–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª–∞—Ö:

**Prisma:** `lib/monitoring/prisma-monitor.ts`
```typescript
const SLOW_QUERY_THRESHOLD = 1000 // ms
const LOG_ALL_QUERIES = process.env.NODE_ENV === 'development'
```

**API:** `lib/monitoring/api-monitor.ts`
```typescript
const SLOW_API_THRESHOLD = 2000 // ms
const LOG_ALL_REQUESTS = process.env.NODE_ENV === 'development'
```

### –†–∞–∑–º–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏

**Prisma –∏ API:**
```typescript
const MAX_STATS = 1000 // –ø–æ—Å–ª–µ–¥–Ω–∏–µ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤
```

**Errors:**
```typescript
const MAX_ERRORS = 50 // –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 –æ—à–∏–±–æ–∫
```

---

## üìö –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: **`MONITORING_GUIDE.md`**

–í–∫–ª—é—á–∞–µ—Ç:
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è
- Best practices
- Workflow –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –£–°–¢–ê–ù–û–í–ö–ò

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
# 1. CLI –ø—Ä–æ–≤–µ—Ä–∫–∞
npm run check-system

# 2. Health check
curl http://localhost:3000/api/health

# 3. –û—Ç–∫—Ä–æ–π—Ç–µ dashboard
# http://localhost:3000/monitoring
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ CLI –ø—Ä–æ–π–¥–µ–Ω—ã
- ‚úÖ Health check –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `"status": "healthy"`
- ‚úÖ Dashboard –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏

---

## üéâ –ì–û–¢–û–í–û!

–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

**–¢–µ–ø–µ—Ä—å –≤—ã –±—É–¥–µ—Ç–µ –≤–∏–¥–µ—Ç—å:**
- üëÄ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î –∏ API
- üêå –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚ùå –í—Å–µ –æ—à–∏–±–∫–∏ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ `/monitoring` - —É–≤–∏–¥–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É —Å—Ä–∞–∑—É
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm run check-system` - –ø–æ–∫–∞–∂–µ—Ç —á—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ - —Ç–∞–º –±—É–¥–µ—Ç –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–≠—Ç–æ —É–∂–µ –ù–ï –ø—Ä–æ–±–ª–µ–º–∞ Supabase - –º—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞ Prisma! üöÄ**

---

**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–î–∞—Ç–∞:** 26 –¥–µ–∫–∞–±—Ä—è 2025

