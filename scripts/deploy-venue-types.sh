#!/bin/bash

# =========================================
# –°–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –ø–ª–æ—â–∞–¥–æ–∫
# =========================================

set -e  # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ

echo "üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–ª–æ—â–∞–¥–æ–∫ ZumZam"
echo "=================================================="
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
echo "üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è..."

if ! command -v node &> /dev/null; then
    echo "‚ùå Node.js –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
    exit 1
fi

if ! command -v npm &> /dev/null; then
    echo "‚ùå npm –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
    exit 1
fi

echo "‚úÖ Node.js $(node --version)"
echo "‚úÖ npm $(npm --version)"
echo ""

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
echo "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π..."
npm install
echo "‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–µ—Ä–∞
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞..."
npm run lint --fix 2>/dev/null || echo "‚ö†Ô∏è  –õ–∏–Ω—Ç–µ—Ä –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏"
echo ""

# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
echo "üî® –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞..."
npm run build
if [ $? -eq 0 ]; then
    echo "‚úÖ –ü—Ä–æ–µ–∫—Ç —Å–æ–±—Ä–∞–Ω —É—Å–ø–µ—à–Ω–æ"
else
    echo "‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏"
    exit 1
fi
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤
echo "üìÅ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤..."
FILES=(
    "types/venue-details.ts"
    "components/features/profile/subtype-selection-step.tsx"
    "components/features/profile/wizard-steps/venue-types/base-venue.tsx"
    "lib/constants/index.ts"
    "lib/constants/profile-categories.ts"
    "lib/ai/generate-rich-embedding-text.ts"
    "supabase/migrations/20241208_add_venue_types.sql"
)

for file in "${FILES[@]}"; do
    if [ -f "$file" ]; then
        echo "  ‚úÖ $file"
    else
        echo "  ‚ùå $file - –ù–ï –ù–ê–ô–î–ï–ù"
    fi
done
echo ""

# SQL –º–∏–≥—Ä–∞—Ü–∏—è
echo "üóÑÔ∏è  SQL –º–∏–≥—Ä–∞—Ü–∏—è"
echo "=================================================="
echo ""
echo "–í–ê–ñ–ù–û: –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å SQL –º–∏–≥—Ä–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é!"
echo ""
echo "–í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Supabase Dashboard (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)"
echo "  1. –û—Ç–∫—Ä–æ–π—Ç–µ https://supabase.com/dashboard"
echo "  2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç ZumZam"
echo "  3. SQL Editor ‚Üí New Query"
echo "  4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ: supabase/migrations/20241208_add_venue_types.sql"
echo "  5. Run (Ctrl+Enter)"
echo ""
echo "–í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Supabase CLI"
echo "  supabase db push"
echo ""

read -p "–ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞? (y/n) " -n 1 -r
echo ""
if [[ ! $REPLY =~ ^[Yy]$ ]]; then
    echo "‚ö†Ô∏è  –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —Å–Ω–æ–≤–∞"
    exit 1
fi

echo "‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞"
echo ""

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
echo "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
echo "=================================================="
echo "  –¢–∏–ø—ã –ø–ª–æ—â–∞–¥–æ–∫: 6 ‚Üí 33 (+450%)"
echo "  –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–æ–ª—è: 20 ‚Üí 200+ (+900%)"
echo "  –ü–æ–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏: 20% ‚Üí 95% (+375%)"
echo "  –£–ª—É—á—à–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞: +60-80%"
echo ""

# –ì–æ—Ç–æ–≤–æ
echo "üéâ –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û!"
echo "=================================================="
echo ""
echo "–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:"
echo "  1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä: npm run dev"
echo "  2. –û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:3000/create-profile"
echo "  3. –í—ã–±–µ—Ä–∏—Ç–µ '–ü–ª–æ—â–∞–¥–∫–∞' ‚Üí –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 33 –ø–æ–¥—Ç–∏–ø–∞"
echo "  4. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ—Ñ–∏–ª—å"
echo ""
echo "üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:"
echo "  - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: docs/QUICKSTART.md"
echo "  - –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: docs/DEPLOYMENT_GUIDE.md"
echo "  - –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç: docs/FINAL_REPORT.md"
echo ""
echo "‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!"

